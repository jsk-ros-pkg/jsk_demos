<launch>
    <arg name="TOPIC_FRONT_RIGHT" default="/spot/depth/frontright"/>
    <arg name="TOPIC_FRONT_LEFT" default="/spot/depth/frontleft"/>
    <arg name="TOPIC_RIGHT" default="/spot/depth/right"/>
    <arg name="TOPIC_LEFT" default="/spot/depth/left"/>
    <arg name="TOPIC_BACK" default="/spot/depth/back"/>

    <!-- front right -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="obstacle_detector_front_right_depth_image_proc"
        args="standalone depth_image_proc/point_cloud_xyz"
        >
        <remap from="camera_info" to="$(arg TOPIC_FRONT_RIGHT)/camera_info"/>
        <remap from="image_rect" to="$(arg TOPIC_FRONT_RIGHT)/image"/>
        <remap from="points" to="$(arg TOPIC_FRONT_RIGHT)/points"/>
    </node>
    <!-- front left -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="obstacle_detector_front_left_depth_image_proc"
        args="standalone depth_image_proc/point_cloud_xyz"
        >
        <remap from="camera_info" to="$(arg TOPIC_FRONT_LEFT)/camera_info"/>
        <remap from="image_rect" to="$(arg TOPIC_FRONT_LEFT)/image"/>
        <remap from="points" to="$(arg TOPIC_FRONT_LEFT)/points"/>
    </node>
    <!-- right -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="obstacle_detector_right_depth_image_proc"
        args="standalone depth_image_proc/point_cloud_xyz"
        >
        <remap from="camera_info" to="$(arg TOPIC_RIGHT)/camera_info"/>
        <remap from="image_rect" to="$(arg TOPIC_RIGHT)/image"/>
        <remap from="points" to="$(arg TOPIC_RIGHT)/points"/>
    </node>
    <!-- left -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="obstacle_detector_left_depth_image_proc"
        args="standalone depth_image_proc/point_cloud_xyz"
        >
        <remap from="camera_info" to="$(arg TOPIC_LEFT)/camera_info"/>
        <remap from="image_rect" to="$(arg TOPIC_LEFT)/image"/>
        <remap from="points" to="$(arg TOPIC_LEFT)/points"/>
    </node>
    <!-- back -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="obstacle_detector_back_depth_image_proc"
        args="standalone depth_image_proc/point_cloud_xyz"
        >
        <remap from="camera_info" to="$(arg TOPIC_BACK)/camera_info"/>
        <remap from="image_rect" to="$(arg TOPIC_BACK)/image"/>
        <remap from="points" to="$(arg TOPIC_BACK)/points"/>
    </node>

    <!-- left obstacle -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="obstacle_detector_front_right_attention_clipper"
        args="standalone jsk_pcl/AttentionClipper"
        >
        <remap from="~input/points" to="$(arg TOPIC_FRONT_RIGHT)/points"/>
        <rosparam subst_value="true">
            initial_pos: [1.0, 0, 0]
            initial_rot: [0, 0, 0]
            dimension_x: 1.0
            dimension_y: 1.5
            dimension_z: 0.5
            frame_id: "body"
        </rosparam>
    </node>
    <node
        pkg="jsk_pcl_ros"
        type="extract_indices"
        name="obstacle_detector_front_right_extract_indices"
        >
        <remap from="~input" to="$(arg TOPIC_FRONT_RIGHT)/points"/>
        <remap from="~indices" to="obstacle_detector_front_right_attention_clipper/output/point_indices"/>
        <remap from="~output" to="/spot_recognition/left_obstacle"/>
    </node>

    <!-- right obstacle -->
    <node
        pkg="nodelet"
        type="nodelet"
        name="obstacle_detector_front_left_attention_clipper"
        args="standalone jsk_pcl/AttentionClipper"
        >
        <remap from="~input/points" to="$(arg TOPIC_FRONT_LEFT)/points"/>
        <rosparam subst_value="true">
            initial_pos: [1.0, 0, 0]
            initial_rot: [0, 0, 0]
            dimension_x: 1.0
            dimension_y: 1.5
            dimension_z: 0.5
            frame_id: "body"
        </rosparam>
    </node>
    <node
        pkg="jsk_pcl_ros"
        type="extract_indices"
        name="obstacle_detector_front_left_extract_indices"
        >
        <remap from="~input" to="$(arg TOPIC_FRONT_LEFT)/points"/>
        <remap from="~indices" to="obstacle_detector_front_left_attention_clipper/output/point_indices"/>
        <remap from="~output" to="/spot_recognition/right_obstacle"/>
    </node>
</launch>
